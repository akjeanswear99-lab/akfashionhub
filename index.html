<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AK FASHION HUB</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style> 
    
* {
  box-sizing: border-box;
  max-width: 100%;
}

html, body {
  margin: 0;
  padding: 0;
  overflow-x: hidden;
  width: 100%;
}

html, body, header {
  margin: 0 !important;
  padding: 0;
  border: 0 !important;
  outline: 0 !important;
  box-shadow: none !important;
}

    #cartPanel{
  position:fixed;
  top:0;
  right:-360px;
  width:340px;
  height:100%;
  background:#fff;
  padding:20px;
  box-shadow:-4px 0 10px rgba(0,0,0,0.3);
  transition:0.3s;
  z-index:10002;
  overflow:auto;
}

body{
    margin:0;
    font-family:Arial, sans-serif;
    background:#f4f4f4;
    color:#333;
}
header{
    background: linear-gradient(135deg, #000000, #1a1a1a);
    color:#fff;
    padding:28px 20px 24px;
    text-align:center;
    position:relative;
   
}

header h1{
    margin:0;
    font-size:38px;      
    letter-spacing:3px; 
    font-weight:800;    
}


header .tagline{
    margin:8px 0 4px;
    font-size:13px;
    letter-spacing:1.2px;
    font-weight:500;
    opacity:0.85;
}

header .address{
    margin-top:6px;
    font-size:10px;     
    letter-spacing:0.6px;
    opacity:0.6;
}


.container{
    max-width:1200px;
    margin:auto;
    padding:20px;
}
.products{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
    gap:18px;
}
.card{
    background:#fff;
    border-radius:8px;
    padding:15px;
    box-shadow:0 4px 8px rgba(0,0,0,0.1);
}
.card img{
    width:100%;
    height:320px;
    object-fit:contain;
    border-radius:6px;
    background:#f7f7f7;
}
.slider{
    position:relative;
}
.slider button{
    position:absolute;
    top:50%;
    transform:translateY(-50%);
    background:rgba(0,0,0,0.5);
    color:#fff;
    border:none;
    padding:5px;
    cursor:pointer;
}
    .slider {
  width: 100%;
  height: auto;
  overflow: hidden;
}

.product-img {
  width: 100%;
  max-height: 500px;
  object-fit: contain;
  display: block;
}
.slider .prev{
    left:0;
}
.slider .next{
    right:0;
}
select, input, textarea, button{
    width:100%;
    padding:8px;
    margin-top:6px;
}
button{
    background:#000;
    color:#fff;
    border:none;
    cursor:pointer;
}
button:disabled{
    background:gray;
}

footer{
    background:#000;
    color:#fff;
    text-align:center;
    padding:15px;
    margin-top:40px;
    width:100vw;
    margin-left:0;
    margin-right:0;
    padding-left:0;
    padding-right:0;
    padding-bottom:120px; 

}
    .card h3{
    font-size:16px;
    margin:6px 0;
}

.card p{
    font-size:13px;
    margin:4px 0;
}
    .menu-icon{
  position:absolute;
  top:22px;
  right:20px;
  cursor:pointer;
  z-index:10001;
}

.menu-icon span{
  display:block;
  width:26px;
  height:3px;
  background:#fff;
  margin:5px 0;
}
#toast{
  position: fixed;
  top: 20px;
  right: 20px;
  background: #000;
  color: #fff;
  padding: 12px 18px;
  border-radius: 6px;
  font-size: 14px;
  opacity: 0;
  transform: translateY(-10px);
  transition: all 0.3s ease;
  z-index: 10000;
}

#toast.show{
  opacity: 1;
  transform: translateY(0);
}

#cartOverlay{
  position: fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background: rgba(0,0,0,0.3);
  z-index:10001;
  display:none;
}

@media (max-width: 768px){

  header h1{
    font-size: 24px;
    letter-spacing: 1px;
  }

  header .tagline{
    font-size: 11px;
  }

  header .address{
    font-size: 9px;
    line-height: 1.4;
  }

  .container{
    padding: 12px;
  }

  .card img{
    height: 260px;
  }

  button{
    font-size: 14px;
    padding: 10px;
  }

  #cartPanel{
    width: 100%;
    right: -100%;
  }
}
    
@media (max-width: 768px){

  .products{
    display: grid;
    grid-template-columns: repeat(2, 1fr); 
    gap: 10px;
  }

  .card{
    padding: 10px;
  }

  .card img{
    height: 200px;
  }

  .card h3{
    font-size: 14px;
  }

  .card p{
    font-size: 12px;
  }

  select, button{
    font-size: 13px;
    padding: 8px;
  }
}

@media (max-width: 768px){

  .card img,
  .product-img{
    width: 100%;
    height: auto;          
    aspect-ratio: 3 / 4;  
    object-fit: contain;   
    background: #f7f7f7;
  }
}

</style>
</head>

<body>
<div id="cartOverlay"></div>

    <header style="position:relative;">
  <h1>AK FASHION HUB</h1>

  <div class="tagline">
    PREMIUM MEN & WOMEN FASHION WEAR
  </div>

  <div class="address">
   ADDRESS:- KESHAV NAGAR, SWARG AASHRAM ROAD, HAPUR 245101
  </div> 
        <div onclick="toggleCart()"
style="
 position:absolute;
 top:22px;
 left:20px;
 cursor:pointer;
 font-size:20px;
 z-index:10002;
">
 üõí
</div>


  <!-- Menu Icon -->

</header>
<!-- CART PANEL -->
<div id="cartPanel">

  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h3>Your Cart</h3>
    <span onclick="toggleCart()" style="cursor:pointer;font-size:22px;">‚úñ</span>
  </div>

  <div id="cartItems"></div>
  <h3 id="total"></h3>
   
<div style="margin:12px 0;">
  <input
    id="couponInput"
    placeholder="Enter offer code"
    style="text-transform:uppercase;"
  >
  <button onclick="applyCoupon()" style="margin-top:6px;">
    Apply Offer
  </button>

  <p id="couponMsg" style="font-size:13px; margin-top:6px;"></p>
</div>


<div id="priceBreakup" style="font-size:14px; margin-top:10px;"></div>


  <div id="checkoutSection">
    <h4>Checkout</h4>

    <input id="name" placeholder="Name">

    <input
      id="phone"
      placeholder="10 digit mobile number"
      maxlength="10"
      inputmode="numeric"
      oninput="this.value=this.value.replace(/[^0-9]/g,'')"
    >

    <textarea
      id="address"
      placeholder="House / Shop No, Street / Area, Landmark, City, State - Pincode"
      rows="4"
    ></textarea>

    <textarea id="note" placeholder="Order Note (Optional)"></textarea>

    <div style="margin-top:10px; font-size:14px;">
      <input type="checkbox" id="terms" style="width:auto;">
      I agree to
      <span
        style="color:#007bff; cursor:pointer; text-decoration:underline;"
        onclick="openTerms()"
      >
        Terms & Conditions
      </span>
    </div>

    <button onclick="checkout()" style="margin-top:10px;">
      Place Order (WhatsApp)
    </button>
  </div>

  <!-- MY ORDERS -->
  <div id="myOrdersSection" style="display:none; margin-top:12px;">
    <input id="orderPhone" placeholder="Enter phone number" maxlength="10">
    <input id="orderIdCheck" placeholder="Enter Order ID">

    <button onclick="showMyOrders()">VIEW ORDERS</button>

    <div id="myOrders" style="margin-top:10px;"></div>

    <button
      style="margin-top:12px;background:#000;color:#fff;"
     onclick="
  document.getElementById('myOrdersSection').style.display='none';
  document.getElementById('checkoutSection').style.display='block';
  document.getElementById('myOrdersBtn').style.display='block';
"
    >
      ‚Üê BACK TO CHECKOUT
    </button>
  </div>

  <button
      id="myOrdersBtn"
    onclick="openMyOrders()"
    style="
      margin-top:12px;
      background:#fff;
      color:#000;
      border:1px solid #000;
      font-weight:bold;
    "
  >
    MY ORDERS
  </button>

</div>



<div class="container">
    <h2>Products</h2>
    <div style="margin-bottom:20px; display:flex; gap:10px;">
  <button onclick="filterProducts('All')">All</button>
  <button onclick="filterProducts('Men')">Men</button>
  <button onclick="filterProducts('Women')">Women</button>
</div>

    <div class="products" id="products"></div>
</div>
<footer>
   <p>
  Return Policy:
  <span
    style="color:#4da3ff; cursor:pointer; text-decoration:underline;"
    onclick="openTerms()"
  >
    (Terms and Conditions Apply)
  </span>
</p>
    
 <p style="margin-bottom:10px; font-size:14px;">
  <b>Follow us on</b>
</p>

<div style="display:flex; justify-content:center; gap:12px; flex-wrap:wrap;">

  <a href="https://www.instagram.com/a_k_fashion_hub_/"
     target="_blank"
     style="
       background:#E1306C;
       color:#fff;
       padding:10px 18px;
       border-radius:25px;
       text-decoration:none;
       font-size:14px;
       font-weight:bold;
     ">
    Instagram
  </a>

  <a href="https://share.google/1K75n4058QJ60W7RZ"
     target="_blank"
     style="
       background:#4285F4;
       color:#fff;
       padding:10px 18px;
       border-radius:25px;
       text-decoration:none;
       font-size:14px;
       font-weight:bold;
     ">
    Google Review
  </a>

</div>
       

</footer>

<script>
// Base64 encoded small colored images for offline use
const img1 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="; // Transparent
const img2 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=="; // Blue
const img3 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=="; // Red
const img4 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=="; // Black

const products = [
{
 id:"AKJ001",
 gender:"Men",  
 name:"Blue Denim Jeans",
 category:"Jeans",
 price:1999,
 discount:20,
 weight: 550, 
 img:["girls-jeans.jpg"],
 colors:["Blue","Black"],
 sizes:["28","30","32","34","36"],
 measure:"Waist, Length, Thigh",
    inventory: {
  "28": { "Black": 5, "Blue": 5 },
  "30": { "Black": 5, "Blue": 5 },
  "32": { "Black": 5, "Blue": 5 },
  "34": { "Black": 5, "Blue": 5 }
}
},
{
 id:"AKL002",
 gender:"Men",
 name:"Black Lower",
 category:"Lower",
 price:1499,
 discount:15,
 weight: 200,
 img:[img3, img4],
 colors:["Black","Gray"],
 sizes:["S","M","L","XL"],
 measure:"Waist, Length, Thigh",
   inventory:{
  "S": { "Black": 5, "Gray": 5 },
  "M": { "Black": 5, "Gray": 5 },
  "L": { "Black": 5, "Gray": 5 },
  "XL": { "Black": 5, "Gray": 5 },
}

},
{
 id:"AKT003",
 gender:"Men",
 name:"Cotton T-Shirt",
 category:"T-Shirt",
 price:999,
 discount:30,
     weight: 180,

 img:[img2, img3],
 colors:["Red","White","Black"],
 sizes:["S","M","L","XL","XXL"],
 measure:"Chest, Waist, Shoulder",
   inventory:{
  "S": { "Black": 5, "Gray": 5 },
  "M": { "Black": 5, "Gray": 5 },
  "L": { "Black": 5, "Gray": 5 },
  "XL": { "Black": 5, "Gray": 5 },
}

},
{
 id:"AKS004",
 gender:"Men",
 name:"Formal Shirt",
 category:"Shirt",
 price:1299,
 discount:25,
     weight: 250,

 img:[img4, img1],
 colors:["White","Blue"],
sizes:["S","M","L","XL"],

inventory:{
  "S": { "Black": 5, "White": 5 },
  "M": { "Black": 5, "White": 5 },
  "L": { "Black": 5, "White": 5 },
  "XL": { "Black": 5, "White": 5 }
}

},
{
 id:"AKK005",
 gender:"Women",
 name:"Embroidered Kurti",
 category:"Kurti",
 price:1799,
 discount:20,
     weight: 220,

 img:[img3, img2],
 colors:["Pink","Green"],
 sizes:["S","M","L"],
 measure:"Chest, Waist, Shoulder, Length",
   inventory:{
  "S": { "Black": 5, "Gray": 5 },
  "M": { "Black": 5, "Gray": 5 },
  "L": { "Black": 5, "Gray": 5 },
  "XL": { "Black": 5, "Gray": 5 },
}

},
    {
 id:"AKS006",
 gender:"Men",
 name:"Formal Shirt",
 category:"Shirt",
 price:1299,
 discount:25,
         weight: 250,

 img:[img4, img1],
 colors:["White","Blue"],
sizes:["28","30","32","34"],

inventory:{
  "28": { "Black": 5, "Blue": 5 },
  "30": { "Black": 5, "Blue": 5 },
  "32": { "Black": 5, "Blue": 5 },
  "34": { "Black": 5, "Blue": 5 }
}

},
    {
 id:"AKS007",
 gender:"Men",
 name:"Formal Shirt",
 category:"Shirt",
 price:1299,
 discount:25,
  weight: 250,

 img:[img4, img1],
 colors:["White","Blue"],
 sizes:["28","30","32","34"],

inventory:{
  "28": { "Black": 5, "Blue": 5 },
  "30": { "Black": 5, "Blue": 5 },
  "32": { "Black": 5, "Blue": 5 },
  "34": { "Black": 5, "Blue": 5 }
}

},
        {
 id:"AKS008",
 gender:"Men",
 name:"Formal Shirt",
 category:"Shirt",
 price:1299,
 discount:25,
  weight: 250,

 img:[img4, img1],
 colors:["White","Blue"],
sizes:["28","30","32","34"],

inventory:{
  "28": { "Black": 5, "Blue": 5 },
  "30": { "Black": 5, "Blue": 5 },
  "32": { "Black": 5, "Blue": 5 },
  "34": { "Black": 5, "Blue": 5 }
}

},
];
   
let cart = JSON.parse(localStorage.getItem('cart')) || [];


  const AUTO_OFFER = {
  minAmount: 1499,  
  discount: 100    
};
  
const COUPONS = {
  "FREEDEL": {
    type: "FREE_DELIVERY"
  },

  "SAVE30": {
    type: "FLAT",
    value: 30
  },

  "SAVE50": {
    type: "FLAT",
    value: 50
  }
};

let appliedCoupon = null;


    let currentFilter = "All";

function filterProducts(type){
  currentFilter = type;
  renderProducts();
}

function renderProducts(){
  const box = document.getElementById("products");
  let html = ""; // ‚úÖ buffer

  products.forEach((p,i)=>{
    if(currentFilter !== "All" && p.gender !== currentFilter) return;

    const final = Math.round(p.price - (p.price * p.discount / 100));

    html += `
      <div class="card">
        <div class="slider">

          <button class="prev" onclick="changeImage(${i}, -1)">‚Äπ</button>

          <img
            id="img${i}"
            src="${p.img[0]}"
            class="product-img"
            onclick="openImage(document.getElementById('img${i}').src)"
          />

          <button class="next" onclick="changeImage(${i}, 1)">‚Ä∫</button>

        </div>

        <p style="font-size:12px; font-weight:bold; color:#555;">
          ${p.gender === "Men" ? "Men‚Äôs Product" : "Women‚Äôs Product"}
        </p>

        <h3>${p.name}</h3>
        <p>SKU: ${p.id}</p>
        <p>${p.category}</p>
        <p>MRP ‚Çπ${p.price} | ${p.discount}% OFF</p>
        <p><b>‚Çπ${final}</b></p>

        <p>Measurements: ${p.measure}</p>

        <select id="size${i}" onchange="updateStockMsg(${i})">
          <option value="">Select Size</option>
          ${p.sizes.map(s=>`<option>${s}</option>`).join("")}
        </select>

        <select id="color${i}" onchange="updateStockMsg(${i})">
          <option value="">Select Color</option>
          ${p.colors.map(c=>`<option>${c}</option>`).join("")}
        </select>

        <p id="stockMsg${i}" style="font-size:12px;font-weight:bold;"></p>

        <button id="btn${i}" onclick="addToCart(${i})">
          Add to Cart
        </button>
      </div>
    `;
  });

  box.innerHTML = html; // ‚úÖ single DOM update
}

function updateStockMsg(i){
  const size = document.getElementById("size"+i).value;
  const color = document.getElementById("color"+i).value;
  const msg = document.getElementById("stockMsg"+i);
  const btn = document.getElementById("btn"+i);

  if(!size || !color){
    msg.innerText = "";
    return;
  }
// ‚úÖ FINAL STOCK CHECK CHECKOUT PE HOGA
msg.innerText = "Stock confirmed at checkout";
msg.style.color = "blue";
btn.disabled = false;

 
}

function changeImage(i, dir){
 const p = products[i];
 const imgEl = document.getElementById("img"+i);
 let current = p.img.indexOf(imgEl.src);
 current = (current + dir + p.img.length) % p.img.length;
 imgEl.src = p.img[current];
}
function showToast(message){
  const toast = document.getElementById("toast");
  toast.innerText = message;
  toast.classList.add("show");

  setTimeout(()=>{
    toast.classList.remove("show");
  },2000);
}

function addToCart(i){
  const size = document.getElementById("size"+i).value;
  const color = document.getElementById("color"+i).value;
  if(!size || !color){
    showToast("Select size & color");
    return;
  }

  const p = products[i];

  // reduce stock
 
let existing = cart.find(
  item => item.id === p.id && item.size === size && item.color === color
);

if(existing){
  // üîí already cart me hai ‚Üí stock limit check
  if(existing.qty < existing.maxStock){
    existing.qty++;
  }else{
    showToast("Stock limit reached");
    return;
  }
}else{
  // üÜï first time add ‚Üí inventory se max stock nikalo
  const maxStock = p.inventory?.[size]?.[color] ?? 0;

  if(maxStock <= 0){
    showToast("Out of stock");
    return;
  }

  cart.push({
    ...p,
    size,
    color,
    qty: 1,
    maxStock: maxStock  
  });
}



  localStorage.setItem("cart", JSON.stringify(cart));

  updateCart();
    showToast("Item added to cart successfully");
    toggleCart();
}

function updateCart(){
  let subtotal = 0;
  const box = document.getElementById("cartItems");
  box.innerHTML = "";

  cart.forEach((c, index)=>{
    const price = Math.round(c.price - (c.price * c.discount / 100));
    subtotal += price * c.qty;

    box.innerHTML += `
      <div style="border-bottom:1px solid #ddd;padding:10px 0;">
        <b>${c.name}</b><br>
        Size: ${c.size} | Color: ${c.color}<br>
        Qty:
        <button onclick="changeQty(${index},-1)">‚àí</button>
        <b>${c.qty}</b>
        <button onclick="changeQty(${index},1)">+</button><br>
        Amount: ‚Çπ${price * c.qty}<br><br>
        <button style="background:red;" onclick="askRemove(${index})">
          Remove Item
        </button>
      </div>
    `;
  });

  const totalWeight = calculateTotalWeight();
  let delivery = calculateDeliveryCharge(totalWeight);

if(cart.length === 0){
  document.getElementById("total").innerHTML = "Your cart is empty";
  document.getElementById("priceBreakup").innerText = "";
  updateCartBadge();
  updateBottomBar(0);
  return;
}

  let discount = 0;
  let offerMsg = "";

  // AUTO OFFER
  if(subtotal >= AUTO_OFFER.minAmount){
    if(subtotal < 3000 && appliedCoupon){
      offerMsg = "Only one offer applicable below ‚Çπ3000";
    }else{
      discount += AUTO_OFFER.discount;
      offerMsg = `üéâ ‚Çπ${AUTO_OFFER.discount} OFF applied`;
    }
  }else{
    offerMsg = `Add ‚Çπ${AUTO_OFFER.minAmount - subtotal} more to get ‚Çπ${AUTO_OFFER.discount} OFF`;
  }

  // COUPON
  if(appliedCoupon){
    const rule = COUPONS[appliedCoupon];

    if(subtotal < 999){
      if(rule.type === "FLAT"){
        discount += Math.min(rule.value, 50);
      }
    }else{
      if(rule.type === "FREE_DELIVERY"){
        delivery = 0;
      }
      if(rule.type === "FLAT"){
        discount += rule.value;
      }
    }
  }

  const finalTotal = Math.max(subtotal + delivery - discount, 0);

  document.getElementById("priceBreakup").innerText = offerMsg;

  document.getElementById("total").innerHTML = `
    <div>Subtotal: ‚Çπ${subtotal}</div>
    <div>Delivery: ‚Çπ${delivery}</div>
    <div>Discount: ‚àí‚Çπ${discount}</div>
    <hr>
    <b>Total Payable: ‚Çπ${finalTotal}</b>
  `;

  updateCartBadge();
  updateBottomBar(finalTotal);
}

 
    


    
    function calculateTotalWeight(){
  let totalWeight = 0;

  cart.forEach(item => {
    const itemWeight = item.weight || 500; 
    totalWeight += itemWeight * item.qty;
  });

  return totalWeight; 
}
function calculateDeliveryCharge(totalWeight){

  if(totalWeight <= 500) return 99;

  if(totalWeight <= 1000) return 149;

  if(totalWeight <= 2000) return 199;

  return 249; // max cap
}


    function changeQty(index, diff){
  const item = cart[index];

 
  if(diff === -1){
    item.qty--;
    if(item.qty <= 0){
      cart.splice(index,1);
    }
  }

  
  if(diff === 1){
  if(item.qty < item.maxStock){
    item.qty++;
  }else{
    showToast("Maximum stock limit reached");
    return;
  }
}


  localStorage.setItem("cart", JSON.stringify(cart));
  updateCart();
}

let removeIndex = null;

function askRemove(index){
  removeIndex = index;
  const item = cart[index];

  document.getElementById("confirmText").innerText =
    `Are you sure you want to remove "${item.name}" from cart?`;

  document.getElementById("confirmBox").style.display = "flex";
}

function confirmYes(){
  const item = cart[removeIndex];

  cart.splice(removeIndex, 1);
  localStorage.setItem("cart", JSON.stringify(cart));

  document.getElementById("confirmBox").style.display = "none";
  showToast("Item removed from cart");
updateCart();
    renderProducts();
}

function confirmNo(){
  document.getElementById("confirmBox").style.display = "none";
}

    function generateOrderId(){
  const now = new Date();
  const date =
    now.getFullYear().toString() +
    String(now.getMonth() + 1).padStart(2, "0") +
    String(now.getDate()).padStart(2, "0");

  const random = Math.floor(1000 + Math.random() * 9000);
  return `AKFH-${date}-${random}`;
}
async function checkout(){


  const termsAccepted = document.getElementById("terms").checked;
  if(!termsAccepted){
    alert("Please accept Terms & Conditions to place order");
    return;
  }

  const n = document.getElementById("name").value.trim();
  const p = document.getElementById("phone").value.trim();
    if(p.length !== 10){
  alert("Enter valid 10 digit mobile number");
  return;
}
  const a = document.getElementById("address").value.trim();
    if(a.length < 20){
  alert("Please enter complete address with landmark, city, state & pincode");
  return;
}
  const note = document.getElementById("note").value.trim();

  if(!n || !p || !a || cart.length === 0){
    showToast("Fill all details and add items to cart");
    return;
  }
      
  for (let item of cart) {

    const response = await fetch(
      "https://script.google.com/macros/s/AKfycbzlZcI0BxlKW_Q_L2XUx7AYPrMqYSTjdj2uHDTS3CLunsmXFuZm04Rb7SsCFVXB7Rn4/exec",
      {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          action: "CHECK_STOCK",
          sku: item.id,
          size: item.size,
          color: item.color
        })
      }
    );

    const result = await response.json();

    if (!result.allowed) {
      alert(
        `${item.name} (${item.size}, ${item.color}) is OUT OF STOCK`
      );
      return; 
    }
  }

  const orderId = generateOrderId();
   
let totalQty = 0;
cart.forEach(c => {
  totalQty += c.qty;
});


let totalAmount = 0;
cart.forEach(c => {
  const price = Math.round(c.price - (c.price * c.discount / 100));
  totalAmount += price * c.qty;
});


let allOrders = JSON.parse(localStorage.getItem("ordersByPhone")) || {};

if (!allOrders[p]) {
  allOrders[p] = [];
}

allOrders[p].push({
  orderId: orderId,
  date: new Date().toLocaleString(),
  items: cart.map(c => ({
    name: c.name,
    size: c.size,
    color: c.color,
    qty: c.qty
  })),
  total: totalAmount,
  status: "Order Received"
});

localStorage.setItem("ordersByPhone", JSON.stringify(allOrders));


  
 fetch("https://script.google.com/macros/s/AKfycbwMWrEhaO4sGqHhUX7nr-zrCtROhYx0krL2Cx6rVbA0pMCenDGP32xDWMrcQb9KgaLi/exec", {
  method: "POST",
  headers: {
    "Content-Type": "application/json"
  },
  body: JSON.stringify({
  orderId: orderId,
  name: n,
  phone: p,
  address: a,
  products: cart.map(c =>
    `${c.name} | SKU:${c.id} | Size:${c.size} | Color:${c.color} | Qty:${c.qty}`
  ).join(" || "),
  totalQty: totalQty,
  totalAmount: totalAmount
})

});


  
  let msg = `AK FASHION HUB
Order ID: ${orderId}
Keshav Nagar, Hapur 245101

`;

  cart.forEach(c=>{
    const price = Math.round(c.price - (c.price * c.discount / 100));
    msg += `${c.name}
SKU:${c.id}
Size:${c.size}
Color:${c.color}
‚Çπ${price}
Qty: ${c.qty}


`;
  });
// ===== TOTAL CALCULATION =====
const subtotal = cart.reduce((sum, c) => {
  const price = Math.round(c.price - (c.price * c.discount / 100));
  return sum + price * c.qty;
}, 0);

const totalWeight = calculateTotalWeight();
const delivery = calculateDeliveryCharge(totalWeight);

let discount = 0;

// auto offer
if(subtotal >= AUTO_OFFER.minAmount){
  discount += AUTO_OFFER.discount;
}

// coupon
if(appliedCoupon){
  const rule = COUPONS[appliedCoupon];
  if(rule?.type === "FLAT") discount += rule.value;
  if(rule?.type === "FREE_DELIVERY") discount += delivery;
}

const finalTotal = Math.max(subtotal + delivery - discount, 0);
msg += `
------------------------
Subtotal: ‚Çπ${subtotal}
Delivery: ‚Çπ${delivery}
Discount: ‚àí‚Çπ${discount}
------------------------
TOTAL PAYABLE: ‚Çπ${finalTotal}
------------------------

`;
  msg += `Customer: ${n}
Phone: ${p}
Address: ${a}
Note: ${note}`;

 window.open("https://wa.me/919599497909?text=" + encodeURIComponent(msg));


alert("Order Placed Successfully!\nYour Order ID: " + orderId);
cart = [];
localStorage.removeItem("cart");
updateCart();
renderProducts();
}

 function toggleCart(){
  const cartPanel = document.getElementById("cartPanel");
  const overlay = document.getElementById("cartOverlay");

  if(cartPanel.style.right === "0px"){
    cartPanel.style.right = window.innerWidth < 768 ? "-100%" : "-360px";
    overlay.style.display = "none";
  }else{
    cartPanel.style.right = "0px";
    overlay.style.display = "block";
  }
}

function applyCoupon(){
  const code = document
    .getElementById("couponInput")
    .value
    .trim()
    .toUpperCase();

  const msg = document.getElementById("couponMsg");

  if(!COUPONS[code]){
    msg.innerText = "‚ùå Invalid offer code";
    msg.style.color = "red";
    appliedCoupon = null;
    updateCart();
    return;
  }

 appliedCoupon = code;
  msg.innerText = "‚úÖ Offer applied successfully";
  msg.style.color = "green";

  updateCart();
}


</script>

<script>
let imageModal = null;

function openImage(src){

  if(!imageModal){
    imageModal = document.createElement("div");
    imageModal.style.position = "fixed";
    imageModal.style.top = "0";
    imageModal.style.left = "0";
    imageModal.style.width = "100%";
    imageModal.style.height = "100%";
    imageModal.style.background = "rgba(0,0,0,0.9)";
    imageModal.style.zIndex = "9999";
    imageModal.style.display = "flex";
    imageModal.style.alignItems = "center";
    imageModal.style.justifyContent = "center";

    imageModal.innerHTML = `
      <img id="zoomImg"
        style="max-width:100%; max-height:100%; cursor:zoom-in;">
    `;

    imageModal.onclick = () => imageModal.style.display = "none";
    document.body.appendChild(imageModal);
  }

  document.getElementById("zoomImg").src = src;
  imageModal.style.display = "flex";
}

  modal.onclick = (e) => {
    if(e.target === modal) modal.remove();
  };

  document.body.appendChild(modal);
}
</script>
<script>
function openTerms(){

 
  document.body.style.overflow = "hidden";

  let modal = document.createElement("div");
  modal.style.position = "fixed";
  modal.style.top = "0";
  modal.style.left = "0";
  modal.style.width = "100%";
  modal.style.height = "100%";
  modal.style.background = "rgba(0,0,0,0.8)";
  modal.style.zIndex = "50000";
  modal.style.display = "flex";
  modal.style.alignItems = "center";
  modal.style.justifyContent = "center";

  modal.innerHTML = `
    <div
      id="termsBox"
      style="
        background:#fff;
        padding:20px;
        width:90%;
        max-width:520px;
        max-height:85%;
        overflow:auto;
        border-radius:8px;
      "
    >
      <h3>Terms & Conditions ‚Äì AK FASHION HUB</h3>

      <p style="font-size:14px; line-height:1.6;">

‚Ä¢ <b>Delivery Time:</b> Orders will be delivered within <b>4‚Äì6 working days</b> after the order is confirmed. Delivery timelines may vary depending on location, courier partner, and operational conditions.<br><br>

‚Ä¢ <b>Cancellation & Refund (Before Dispatch):</b> Orders cancelled within <b>12 hours</b> of placing the order are eligible for a <b>full refund</b>. The refund amount will be processed and credited within <b>2‚Äì3 working days</b> after cancellation confirmation.<br><br>

‚Ä¢ <b>Cancellation Policy (After Dispatch):</b> Once the order has been <b>dispatched</b>, cancellation will <b>not be allowed</b>. In such cases, the customer is required to make <b>full payment</b> for the order.<br><br>

‚Ä¢ <b>Product Images Disclaimer:</b> All product images displayed on this website are captured using professional camera equipment or generated/enhanced using AI technology. Due to variations in screen resolution, lighting conditions, camera settings, and pixel density, there may be slight differences in color, texture, or appearance between the images shown and the actual product received.<br><br>

‚Ä¢ <b>Return & Replacement Request:</b> Any return or replacement request must be raised within <b>3 days</b> from the date of product delivery.<br><br>

‚Ä¢ <b>Mandatory Proof:</b> A <b>clear unboxing video</b> along with <b>clear photos</b> of the received product is mandatory for all return or replacement requests. Requests without proper video and photo proof will not be accepted under any circumstances.<br><br>

‚Ä¢ <b>Product Condition:</b> The product must be <b>unused, unwashed, undamaged, and in original condition</b>. Products that are worn, washed, dirty, altered, or damaged will not be eligible for return or replacement.<br><br>

‚Ä¢ <b>Invoice Requirement:</b> The <b>original invoice/bill</b> provided with the product must be submitted at the time of return or replacement. Requests without the original invoice will not be processed.<br><br>

‚Ä¢ <b>Refund Eligibility:</b> Refunds will be issued <b>only</b> in cases where an <b>incorrect or damaged product</b> has been delivered by AK FASHION HUB.<br><br>

‚Ä¢ <b>Size & Fit Issues:</b> In case of size or fitting issues, <b>only replacement will be provided</b>. Refunds are <b>not applicable</b> for size or fitting concerns.<br><br>

‚Ä¢ <b>Shipping Charges:</b> For size or fitting replacements, the customer is required to pay <b>one-side delivery/shipping charges</b>.<br><br>

‚Ä¢ <b>Color Variation Disclaimer:</b> Minor color differences may occur due to screen brightness, display settings, and lighting conditions. Such variations shall <b>not be considered a defect</b>.<br><br>

‚Ä¢ <b>Agreement:</b> By placing an order, the customer confirms that they have <b>read, understood, and agreed</b> to all the above Terms & Conditions.

      </p>

      <div id="scrollHint" style="font-size:12px;text-align:center;color:#666;">
        ‚¨áÔ∏è Scroll down to enable button
      </div>

      <button
        id="agreeBtn"
        disabled
        style="
          width:100%;
          margin-top:10px;
          padding:10px;
          background:gray;
          color:#fff;
          border:none;
          cursor:not-allowed;
        "
      >
        I Agree
      </button>
    </div>
  `;

  document.body.appendChild(modal);

  const box = modal.querySelector("#termsBox");
  const btn = modal.querySelector("#agreeBtn");
  const hint = modal.querySelector("#scrollHint");

  // üîí scroll compulsory
  box.addEventListener("scroll", () => {
  box.scrollTop + box.clientHeight >= box.scrollHeight - 20) {
      btn.disabled = false;
      btn.style.background = "#000";
      btn.style.cursor = "pointer";
      hint.style.display = "none";
    }
  });

 
  btn.onclick = () => {
    document.getElementById("terms").checked = true;
    modal.remove();
    document.body.style.overflow = "";
  };


  modal.onclick = (e) => {
    if (e.target === modal) {
      modal.remove();
      document.body.style.overflow = "";
    }
  };
}
</script>


</script>
    
   <a href="https://wa.me/919599497909?text=Hello%20AK%20FASHION%20HUB%20%F0%9F%91%8B%0A%0AI%20am%20interested%20in%20your%20products.%0APlease%20share%20product%20details,%20price,%20size%20availability,%20and%20delivery%20information.%0A%0AThank%20you."
   target="_blank"
   style="
     position:fixed;
     bottom:100px;
     right:16px;
     background:#25D366;
     color:white;
     padding:14px 20px;
     border-radius:30px;
     text-decoration:none;
     font-weight:bold;
     font-size:15px;
     box-shadow:0 4px 10px rgba(0,0,0,0.3);
     z-index:9999;
     display:flex;
     align-items:center;
     gap:8px;
   ">
 üí¨ Help & Support
</a>

    <script>

        

       const noteField = document.getElementById("note");

noteField.oninput = function () {
  const words = this.value.trim().split(/\s+/);
  if (words.length > 30) {
    this.value = words.slice(0, 30).join(" ");
  }
};

  
function updateCartBadge(){
  let badge = document.getElementById("cartCount");

  if(!badge){
    const cartIcon = document.querySelector('[onclick="toggleCart()"]');
    badge = document.createElement("span");
    badge.id = "cartCount";
    badge.style.background = "red";
    badge.style.color = "white";
    badge.style.borderRadius = "50%";
    badge.style.padding = "2px 6px";
    badge.style.fontSize = "12px";
    badge.style.marginLeft = "6px";
    cartIcon.appendChild(badge);
  }

  let totalQty = 0;
cart.forEach(i => totalQty += i.qty);
badge.innerText = totalQty;

}

function updateBottomBar(total){
  let bar = document.getElementById("bottomCartBar");

  if(!bar){
    bar = document.createElement("div");
    bar.id = "bottomCartBar";
    bar.style.position = "fixed";
    bar.style.bottom = "0";
    bar.style.left = "0";
    bar.style.width = "100%";
    bar.style.background = "#000";
    bar.style.color = "#fff";
    bar.style.padding = "12px";
    bar.style.display = "none";
    bar.style.justifyContent = "space-between";
    bar.style.alignItems = "center";
    bar.style.zIndex = "9999";
    bar.onclick = toggleCart;

    document.body.appendChild(bar);
  }

  if(window.innerWidth < 768 && cart.length > 0){
    bar.style.display = "flex";
    bar.innerHTML = `üõí View Cart (${cart.reduce((s,i)=>s+i.qty,0)}) <b>‚Çπ${total}</b>`;
  }else{
    bar.style.display = "none";
  }
}
function showMyOrders(){
  const phone = document.getElementById("orderPhone").value.trim();
  const orderIdInput = document.getElementById("orderIdCheck").value.trim();
  const box = document.getElementById("myOrders");

  

  const allOrders = JSON.parse(localStorage.getItem("ordersByPhone")) || {};
  const orders = allOrders[phone];


  if (!orders) {
    box.innerHTML = "<p>Invalid phone number or Order ID</p>";
    return;
  }

  
  const matched = orders.some(o => o.orderId === orderIdInput);

  if (!matched) {
    box.innerHTML = "<p>Invalid phone number or Order ID</p>";
    return;
  }

  // ‚úÖ dono match ho gaye ‚Üí saare orders dikhao
  let html = "";

  orders.forEach(o => {
    html += `
      <div style="border:1px solid #ddd; padding:8px; margin-bottom:8px;">
        <b>Order ID:</b> ${o.orderId}<br>
        <b>Date:</b> ${o.date}<br>
        <b>Status:</b> ${o.status}<br>
        <b>Total:</b> ‚Çπ${o.total}<br>
        <b>Items:</b><br>
        ${o.items.map(i =>
          `‚Ä¢ ${i.name} (${i.size}, ${i.color}) √ó ${i.qty}`
        ).join("<br>")}
      </div>
    `;
  });

  box.innerHTML = html;
}
renderProducts();


        const cartOverlay = document.getElementById("cartOverlay");
cartOverlay.onclick = toggleCart;

function openMyOrders(){
  document.getElementById("checkoutSection").style.display = "none";
  document.getElementById("myOrdersSection").style.display = "block";
  document.getElementById("myOrdersBtn").style.display = "none";
}
    </script>


        <div id="toast"></div>

<div id="confirmBox" style="
  position:fixed;
  top:0; left:0;
  width:100%; height:100%;
  background:rgba(0,0,0,0.6);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:10000;
">
  <div style="
    background:#fff;
    padding:20px;
    width:90%;
    max-width:320px;
    border-radius:8px;
    text-align:center;
  ">
    <p id="confirmText" style="margin-bottom:15px;font-weight:bold;"></p>
    <button onclick="confirmYes()" style="width:45%;margin-right:5%;">OK</button>
    <button onclick="confirmNo()" style="width:45%;background:#ccc;color:#000;">Cancel</button>
  </div>
</div>


</body>
</html>
